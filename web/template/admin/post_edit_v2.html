{{template "base" .}}

{{define "content"}}
{{$initial := dict "content" ""}}
{{if .post}}
	{{if .post.Content}}
		{{$initial = dict "content" .post.Content}}
	{{end}}
{{end}}

<style>
	body.milkdown-immersive {
		background-color: var(--crepe-color-background, #ffffff);
	}

	body.milkdown-immersive header,
	body.milkdown-immersive footer {
		display: none !important;
	}

	body.milkdown-immersive main {
		max-width: 100vw !important;
		width: 100vw !important;
		padding: 0 !important;
		min-height: 100vh;
	}

	body.milkdown-immersive main > * {
		margin: 0;
		height: 100vh;
	}

	.milkdown-immersive-shell {
		display: flex;
		flex-direction: column;
		height: 100%;
	}

	.milkdown-immersive-shell .milkdown {
		flex: 1 1 auto;
		min-height: 0;
	}
</style>

<div class="milkdown-immersive-shell">
	<div id="milkdown-app" class="milkdown"></div>
</div>

<script>
window.__MILKDOWN_V2__ = {{$initial | toJSON}};
document.body.classList.add('milkdown-immersive');
window.addEventListener('pagehide', () => {
	document.body.classList.remove('milkdown-immersive');
	const crepe = window.MilkdownV2?.crepe;
	if (crepe && typeof crepe.destroy === 'function') {
		void crepe.destroy();
	}
}, { once: true });
</script>
<script type="module" src="/static/dist/assets/milkdown_v2.js"></script>
{{end}}
