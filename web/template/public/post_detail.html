{{template "base" .}} {{define "content"}}
<style>
    body.bg-white {
        background-color: var(--surface-soft-light) !important;
    }

    .post-content a {
        text-decoration: none;
    }

    .post-content a:hover {
        text-decoration: underline;
        text-underline-offset: 3px;
    }

    .post-content [data-milkdown-viewer].milkdown .preview-toggle-button,
    .post-content [data-milkdown-viewer] .preview-toggle-button {
        display: none !important;
    }

    .post-content
        [data-milkdown-viewer]
        .milkdown-code-block
        .tools-button-group
        button:last-child {
        display: none;
    }

    .post-content strong,
    .post-content b {
        font-weight: 800;
        color: #16a34a;
    }

    .post-content :is(h1, h2, h3, h4, h5, h6) strong,
    .post-content :is(h1, h2, h3, h4, h5, h6) b {
        color: inherit;
    }
    {{template "milkdown_callout_styles"}}

    [data-toc-content] h1,
    [data-toc-content] h2,
    [data-toc-content] h3 {
        scroll-margin-top: 6.5rem;
    }

    [data-toc-card] nav::before {
        content: "";
        position: absolute;
        top: 0.5rem;
        bottom: 0.75rem;
        left: 0.75rem;
        width: 1px;
    }

    [data-toc-card] ul {
        list-style: none;
        margin: 0;
        padding: 0;
    }

    [data-toc-card] .toc-item {
        position: relative;
    }

    [data-toc-card] .toc-link {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        min-width: 0;
        font-size: 0.875rem;
        line-height: 1.4;
        color: rgb(100, 116, 139);
        text-decoration: none;
    }

    [data-toc-card] .toc-link:focus-visible {
        outline: 2px solid rgba(59, 130, 246, 0.4);
        outline-offset: 4px;
        border-radius: 12px;
    }

    [data-toc-card] .toc-tick {
        height: 2px;
        width: 14px;
        border-radius: 9999px;
        flex-shrink: 0;
        background-color: rgba(148, 163, 184, 0.5);
        transition:
            background-color 0.2s ease,
            width 0.2s ease;
    }

    [data-toc-card] .toc-text {
        display: block;
        flex: 1 1 auto;
        min-width: 0;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
        max-width: 100%;
    }

    [data-toc-card] .toc-item[data-level="2"] .toc-text {
        margin-left: 0.75rem;
    }

    [data-toc-card] .toc-item[data-level="3"] .toc-text {
        margin-left: 1.5rem;
    }

    [data-toc-card] .toc-item.is-active .toc-link {
        color: rgb(30, 64, 175);
        font-weight: 600;
    }

    [data-toc-card] .toc-item.is-active .toc-tick {
        width: 18px;
        background-color: rgb(59, 130, 246);
    }

    @media (prefers-color-scheme: dark) {
        body.bg-white {
            background-color: var(--surface-soft-dark) !important;
        }

        .post-content .katex,
        .post-content .katex-display,
        .post-content .math,
        .post-content .math-display,
        .post-content .math-block,
        .post-content .math-inline {
            color: #e2e8f0;
        }

        .post-content .katex-display,
        .post-content .math-display,
        .post-content .math-block {
            background-color: transparent;
        }

        .post-content [data-milkdown-viewer],
        .post-content [data-milkdown-viewer].milkdown,
        .post-content [data-milkdown-viewer] .milkdown {
            --crepe-color-background: #020617;
            --crepe-color-on-background: #e2e8f0;
            --crepe-color-surface: #0f172a;
            --crepe-color-surface-low: #0b1629;
            --crepe-color-on-surface: #e2e8f0;
            --crepe-color-on-surface-variant: #cbd5e1;
            --crepe-color-outline: #1f2f46;
            --crepe-color-primary: #7dd3fc;
            --crepe-color-secondary: #13203c;
            --crepe-color-on-secondary: #e0f2fe;
            --crepe-color-inverse: #e2e8f0;
            --crepe-color-on-inverse: #020617;
            --crepe-color-inline-code: #fbbf24;
            --crepe-color-error: #fda4af;
            --crepe-color-hover: rgba(255, 255, 255, 0.06);
            --crepe-color-selected: rgba(125, 211, 252, 0.22);
            --crepe-color-inline-area: #11233f;
            --crepe-shadow-1:
                0 18px 48px rgba(0, 0, 0, 0.5), 0 8px 20px rgba(0, 0, 0, 0.35);
            --crepe-shadow-2:
                0 24px 64px rgba(0, 0, 0, 0.55), 0 12px 24px rgba(0, 0, 0, 0.35);
            background-color: #020617;
            color: #e2e8f0;
        }

        .post-content [data-milkdown-viewer].milkdown .milkdown-code-block,
        .post-content [data-milkdown-viewer] .milkdown-code-block {
            border: 1px solid #1f2f46;
            box-shadow: none;
            background-color: #0f172a;
        }

        .post-content
            [data-milkdown-viewer].milkdown
            .milkdown-code-block
            .preview-panel,
        .post-content
            [data-milkdown-viewer]
            .milkdown-code-block
            .preview-panel {
            color: #e2e8f0;
            background-color: #0f172a;
        }

        .post-content
            [data-milkdown-viewer].milkdown
            .milkdown-code-block
            .cm-editor,
        .post-content [data-milkdown-viewer] .milkdown-code-block .cm-editor,
        .post-content
            [data-milkdown-viewer].milkdown
            .milkdown-code-block
            .cm-gutters,
        .post-content [data-milkdown-viewer] .milkdown-code-block .cm-gutters {
            background-color: #0f172a;
            color: #e2e8f0;
        }

        .post-content .milkdown-preview.milkdown,
        .post-content .milkdown-preview .milkdown {
            background-color: transparent;
        }

        [data-toc-card] {
            background-color: transparent;
            border-color: transparent;
            box-shadow: none;
        }

        [data-toc-card] .toc-link:focus-visible {
            outline-color: rgba(148, 197, 255, 0.55);
        }

        [data-toc-card] nav::before {
            background: linear-gradient(
                180deg,
                rgba(71, 85, 105, 0.55),
                rgba(71, 85, 105, 0.15)
            );
        }

        [data-toc-card] .toc-link {
            color: rgba(148, 163, 184, 0.9);
        }

        [data-toc-card] .toc-tick {
            background-color: rgba(148, 163, 184, 0.35);
        }

        [data-toc-card] .toc-item.is-active .toc-link {
            color: rgba(191, 219, 254, 0.95);
        }

        [data-toc-card] .toc-item.is-active .toc-tick {
            background-color: rgba(191, 219, 254, 0.95);
        }
    }
</style>
<article class="mx-auto mt-10 w-full max-w-6xl px-6 xl:px-8">
    <div class="grid gap-12 xl:grid-cols-[minmax(0,1fr)_292px]">
        <div class="space-y-10">
            <header class="space-y-6">
                <h1 class="page-title">{{.post.Title}}</h1>
                <div
                    class="flex flex-wrap gap-3 text-xs text-slate-500 dark:text-slate-400"
                >
                    {{if gt .post.ReadingTime 0}}
                    <span class="flex items-center"
                        >{{printf (tr .language "%d min read" "%d 分钟阅读")
                        .post.ReadingTime}}</span
                    >
                    {{end}}
                    <span class="flex items-center"
                        >{{printf (tr .language "%d views" "%d 次浏览")
                        .pageViews}}</span
                    >
                    <span class="flex items-center"
                        >{{formatDate .post.PublishedAt}}</span
                    >
                    {{range .post.Tags}}
                    <span
                        class="rounded-full bg-slate-100 px-3 py-1 text-slate-600 dark:bg-slate-800/80 dark:text-slate-300"
                        >{{.Name}}</span
                    >
                    {{end}}
                </div>
                <!-- {{if .post.CoverURL}}
				<div class="relative w-full overflow-hidden rounded-3xl shadow-md shadow-slate-200/60 dark:shadow-slate-900/80" style="padding-top: {{aspectPadding .post.CoverWidth .post.CoverHeight}};">
					<img src="{{.post.CoverURL}}" alt="{{.post.Title}} {{tr .language "Cover" "封面"}}" class="absolute inset-0 h-full w-full object-cover" loading="lazy">
				</div>
				{{else}}
				<div
					class="flex h-72 w-full items-center justify-center rounded-3xl bg-gradient-to-br {{accent .post.Title}} text-5xl font-semibold text-white shadow-md">
					{{initials .post.Title}}
				</div>
				{{end}} -->
            </header>

            <section class="post-content callout-scope space-y-8">
                {{- if .post.Summary }}
                <aside
                    class="rounded-2xl border border-amber-200 bg-amber-50 p-6 text-left shadow-sm dark:border-amber-500/30 dark:bg-amber-500/10"
                >
                    <div
                    class="text-xs font-extrabold uppercase tracking-wide text-amber-600 dark:text-amber-300"
                >
                    {{tr .language "AI Summary" "AI 摘要"}}
                </div>
                    <p
                        class="mt-2 text-base leading-relaxed text-amber-900 dark:text-amber-100/90"
                    >
                        {{.post.Summary}}
                    </p>
                </aside>
                {{- end }}
                <div
                    id="post-milkdown-viewer"
                    class="milkdown-preview hidden"
                    data-milkdown-viewer
                    data-toc-content
                ></div>
                <div
                    id="post-html-fallback"
                    data-post-fallback
                    data-toc-content
                >
                    {{.content}}
                </div>
            </section>

            <script type="application/json" id="post-markdown-data">
                {{- toJSON .post.Content -}}
            </script>

            {{template "contact_links.html" (dict "Contacts" .contacts "Heading"
            (tr .language "Contact the author" "联系作者") "Subtitle" (tr .language "Find me on these platforms." "在这些平台找到我。") "Language" .language)}}
        </div>

        <aside class="hidden xl:block">
            <div class="sticky top-28">
                <div
                    data-toc-card
                    hidden
                    class="overflow-hidden rounded-3xl bg-transparent p-6 transition-transform duration-200"
                >
                    <div
                        class="text-xs font-semibold uppercase tracking-[0.28em] text-slate-400 dark:text-slate-500"
                    >
                        {{tr .language "Contents" "目录"}}
                    </div>
                    <nav class="relative mt-5" aria-label="Table of contents">
                        <ul class="space-y-3" data-toc-list></ul>
                    </nav>
                </div>
            </div>
        </aside>
    </div>
</article>
{{end}}
