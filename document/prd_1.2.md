# CommitLog 项目开发计划 1.2

## 0. 版本定位与目标

### 0.1 背景
- V1 已交付博客 CRUD、后台 Markdown 编辑、关于我页面等基础能力。
- V2 曾完成习惯管理工作流、关于我页前台展示及 Fly.io 生产部署，但仍有部分体验与工程化事项未落实；本版本起下线习惯模块，聚焦博客主线能力。
- V3 聚焦“面向公众可全面体验的版本”，需要在体验、自动化运维、AI 亮点与可观测性上补齐差距，实现产品愿景中尚未落地的关键能力。
- V3 交付完成以后，需要可以直接面向用户开放的状态。

### 0.2 版本目标
1. **内容创作体验升级**：提供沉浸式编辑体验与稳定的 Markdown 能力。
2. **自动化与可靠性**：让部署、备份、监控形成闭环，降低运维风险。
3. **AI 与互动价值兑现**：补齐 V1 愿景中尚未交付的 AI 能力与互动体验。
4. **用户体验与品牌感知**：优化访客端视觉/交互细节，提升整体品牌质感。

---

## 1. 产品规划

### 1.1 优先级定义
- **P0**：必须完成，直接影响核心价值或稳定性。
- **P1**：强烈期望完成，显著提升体验或效率。
- **P2**：锦上添花，可根据时间窗口滚动规划。

---

## 2. 功能需求
### P0 平台内容基础优化
- **功能点** 
  - 基础模板、文案优化，整体更加去除 AI 味
- **验收标准**
  - 平台文案更加贴切自然、可复用

### P0 SEO 信息 Review
- **功能点**
  - SEO 基础配置
- **验收标准**
  - SEO 配置符合最佳实践

### P0 AI 内容能力
- **AI 划词改写**：编辑器里针对选中句子，可以给 AI 提要求改写。
- **AI 一键全文优化**：针对当前文章，AI 根据统一的 Prompt 优化全文。
- **AI 文章总结**：文章发布时自动生成摘要，展示于列表/SEO meta description。
- **验收标准**：
  - 选中句子可以自由按照要求进行改写，如幽默一点，口语化一点等;
  - 支持全文优化，并且可以预览优化结果;
  - 支持 OpenAI API Key 配置；
  - 生成内容可手动编辑；
  - 有失败兜底策略（显示提示、可重试）。

### P0 支持文章阅读数 UV/PV 统计
- **功能点**
  - 数据库统计 UV/PV
  - 前端页面展示当前文章 PV
  - 后台展示文章详细 UV/PV,以及总体的 UV/PV
- **验收标准**
  - 基础功能满足

### P1 Markdown 编辑体验升级
- **需求背景**：现有 EasyMD 插件体验欠佳，无法支撑长文创作。
- **功能点**：
  - 替换为支持插件体系的编辑器（如 TipTap/Editor.js），需支持 Markdown 导入导出。
  - 提供 **Zen Mode**（全屏/沉浸写作），保留实时预览。
  - 保留图片上传、代码块语法高亮、Mermaid 渲染。
- **验收标准**：
  - 10k 字长文编辑无明显卡顿；
  - 触发 Zen Mode 时，仅保留工具栏与编辑区；
  - Markdown Round-trip（导入→编辑→导出）内容一致；
  - 回归现有文章编辑/发布流程。

### P1 自动化部署与数据库备份
- **功能点**：
  - 基于 GitHub Actions 构建流水线：lint/test → 构建镜像 → 部署至 Fly.io。
  - 主干分支合并自动触发部署；可选配置手动触发预发部署。
  - Fly.io 上配置每日定时任务，备份 SQLite 至 Fly Volumes + S3 兼容存储。
- **验收标准**：
  - 任意 PR 合并后自动部署成功且可追踪日志；
  - 备份脚本失败有告警（邮件/Slack Webhook）。

### P1 访客端交互组件升级
- **功能点**：
  - 自定义 Modal、Select、Toast 组件替换浏览器原生样式。
  - 遵循设计四原则，保持响应式；优先复用 Tailwind + Alpine.js。
  - Modal 支持键盘操作、点击遮罩关闭；Select 支持搜索；Toast 支持多实例队列。
- **验收标准**：
  - 管理后台与前台常用操作均应用新组件；
  - 无无障碍阻塞问题（tab 序、aria 属性齐全）。

### P2 可观测性基线
- **功能点**：
  - 接入结构化日志（JSON），关键请求包含 trace_id、用户信息、耗时。
- **验收标准**：
  - 通过日志查看指定请求的全链路信息；
  - Dashboard 可查看过去 24 小时核心指标；

好的 ✅ 我帮你把 V3 的 PRD 需求细化成一个可直接执行的 **Checklist**，每一条都用 `[ ]` 标记，方便后续逐条打勾。
我会按 **优先级（P0 → P1 → P2）** 分组整理。

---

## 执行 Checklist

### P0 必须完成

#### 平台内容基础优化

* [x] 优化基础模板（前台/后台统一风格）
* [x] 修订站点文案，去除 AI 腔调
* [x] 抽取后台可配置信息页面

#### SEO 信息 Review

* [x] 配置 meta title、meta description、keywords
* [x] 配置 sitemap.xml 并自动更新
* [x] 配置 robots.txt 并确认搜索引擎可正确抓取
* [x] 每个页面支持自定义 meta 信息（文章/关于页）

#### AI 内容能力

* [ ] ~~编辑器内支持 **AI 划词改写**~~
* [ ] ~~支持“幽默化/口语化/专业化”等可选改写风格（和编辑器耦合太深本期不做）~~
* [x] 编辑器支持 **全文优化** 功能（优化前可预览）
    - 文章草稿页新增「AI 全文优化」按钮，一次性将当前全文发送至模型。
    - 优化结果在弹窗内与原文左右分栏对照展示，支持继续编辑与一键替换。
    - 弹窗保留「重新生成」「替换」「关闭」操作，失败时提示并可重试。
* [x] 支持 OpenAI API Key 配置
* [x] 支持 AI 摘要生成能力
* [x] 自动摘要用于：文章列表卡片、副标题、SEO meta description
* [x] 生成结果可手动编辑
* [x] 失败时兜底提示（支持重试）

#### 文章阅读数 UV/PV 统计

* [x] 后端数据库新增 UV/PV 统计逻辑
* [x] 前端文章详情页显示当前文章 PV
* [x] 后台文章管理页显示每篇文章 UV/PV
* [x] 后台提供站点总体 UV/PV 报表
* [x] 确认去重逻辑（同一访客短时间多次访问算一次）

#### 下线习惯打卡功能

* [x] 下线习惯打卡功能 

---

### P1 强烈期望完成

#### Markdown 编辑体验升级

* [ ] ~~替换 EasyMD → Milkdown（后续尝试重构整个后台文章编辑的逻辑，本期先不做）~~
* [ ] ~~支持 Zen Mode（全屏沉浸写作）~~

#### 自动化部署与数据库备份

* [x] GitHub Actions 配置：lint/test → 构建 → 部署 Fly.io
* [x] main 分支合并后自动部署生产环境
* [x] 支持手动触发预发部署
* [ ] ~~Fly.io 配置每日定时任务：备份 SQLite~~
      - fly.io 支持天级别快照无需自己再弄一份
* [ ] ~~备份至 Fly Volumes + S3（兼容方案）~~
* [ ] ~~备份失败有告警（邮件/Slack Webhook）~~
* [ ] ~~确认备份可用性（定期恢复测试）~~
